{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-05T12:20:39.240120Z", "invocation_id": "ca9dba5e-4139-4dba-bfc0-e1ab35b1878b", "invocation_started_at": "2025-12-05T12:20:25.021829Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:28.260274Z", "completed_at": "2025-12-05T12:20:28.289729Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:28.291669Z", "completed_at": "2025-12-05T12:20:29.611472Z"}], "thread_id": "Thread-1", "execution_time": 1.3654189109802246, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_circuits", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".circuits\n\n),\n\nrenamed as (\n\n    select\n        source.\"circuitId\" as circuit_id,\n        source.\"circuitRef\" as circuit_ref,\n        source.name as circuit_name,\n        source.location,\n        source.country,\n        source.lat as latitude,\n        source.lng as longitude,\n        source.alt as altitude,\n        source.url\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_circuits", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:28.279707Z", "completed_at": "2025-12-05T12:20:28.302819Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:28.360879Z", "completed_at": "2025-12-05T12:20:29.613865Z"}], "thread_id": "Thread-3", "execution_time": 1.3648309707641602, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_constructor_standings", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".constructor_standings\n\n),\n\nrenamed as (\n\n    select\n        source.\"constructorStandingsId\" as constructor_standings_id,\n        source.\"raceId\" as race_id,\n        source.\"constructorId\" as constructor_id,\n        source.points,\n        source.position,\n        source.\"positionText\" as position_text,\n        source.wins\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_constructor_standings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:28.285030Z", "completed_at": "2025-12-05T12:20:28.332118Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:28.400604Z", "completed_at": "2025-12-05T12:20:29.616563Z"}], "thread_id": "Thread-4", "execution_time": 1.3629467487335205, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_constructors", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".constructors\n\n),\n\nrenamed as (\n\n    select\n        source.\"constructorId\" as constructor_id,\n        source.\"constructorRef\" as constructor_ref,\n        name as constructor_name,\n        nationality,\n        url\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_constructors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:28.274496Z", "completed_at": "2025-12-05T12:20:28.290515Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:28.321223Z", "completed_at": "2025-12-05T12:20:29.608142Z"}], "thread_id": "Thread-2", "execution_time": 1.3676397800445557, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_constructor_results", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".constructor_results\n\n),\n\nrenamed as (\n\n    select\n        source.\"constructorResultsId\" as constructor_results_id,\n        source.\"raceId\" as race_id,\n        source.\"constructorId\" as constructor_id,\n        source.points,\n        nullif(status, '\\\\N') as status\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_constructor_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:29.729331Z", "completed_at": "2025-12-05T12:20:29.764179Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:29.767723Z", "completed_at": "2025-12-05T12:20:30.953083Z"}], "thread_id": "Thread-3", "execution_time": 1.3815271854400635, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_drivers", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".drivers\n\n),\n\nrenamed as (\n\n    select\n        source.\"driverId\" as driver_id,\n        source.\"driverRef\" as driver_ref,\n        number as driver_number,\n        code as driver_code,\n        forename,\n        surname,\n        dob as date_of_birth,\n        nationality,\n        url\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_drivers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:29.654135Z", "completed_at": "2025-12-05T12:20:29.765907Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:29.789851Z", "completed_at": "2025-12-05T12:20:31.382628Z"}], "thread_id": "Thread-1", "execution_time": 1.7486069202423096, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_driver_standings", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".driver_standings\n\n),\n\nrenamed as (\n\n    select\n        source.\"driverStandingsId\" as driver_standings_id,\n        source.\"raceId\" as race_id,\n        source.\"driverId\" as driver_id,\n        points,\n        position,\n        source.\"positionText\" as position_text,\n        wins\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_driver_standings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:29.752125Z", "completed_at": "2025-12-05T12:20:29.780625Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:29.833329Z", "completed_at": "2025-12-05T12:20:31.387151Z"}], "thread_id": "Thread-2", "execution_time": 1.7480378150939941, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_qualifying", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".qualifying\n\n),\n\nrenamed as (\n\n    select\n        source.\"qualifyId\" as qualify_id,\n        source.\"raceId\" as race_id,\n        source.\"driverId\" as driver_id,\n        source.\"constructorId\" as constructor_id,\n        number as driver_number,\n        position,\n        nullif(q1, '\\\\N') as q1_time,\n        nullif(q2, '\\\\N') as q2_time,\n        nullif(q3, '\\\\N') as q3_time\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_qualifying", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:29.745201Z", "completed_at": "2025-12-05T12:20:29.772878Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:29.809654Z", "completed_at": "2025-12-05T12:20:31.391665Z"}], "thread_id": "Thread-4", "execution_time": 1.7509651184082031, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_lap_times", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".lap_times\n\n),\n\nrenamed as (\n\n    select\n        source.\"raceId\" as race_id,\n        source.\"driverId\" as driver_id,\n        lap,\n        position,\n        time as lap_time,\n        milliseconds as lap_time_milliseconds\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_lap_times", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:31.090122Z", "completed_at": "2025-12-05T12:20:31.164111Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:31.206474Z", "completed_at": "2025-12-05T12:20:32.505769Z"}], "thread_id": "Thread-3", "execution_time": 1.4252421855926514, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_races", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".races\n\n),\n\nrenamed as (\n\n    select\n        source.\"raceId\" as race_id,\n        year as season_year,\n        round as race_round,\n        source.\"circuitId\" as circuit_id,\n        name as race_name,\n        date as race_date,\n        nullif(time, '\\\\N') as race_time,\n        url,\n        nullif(fp1_date, '\\\\N') as fp1_date,\n        nullif(fp1_time, '\\\\N') as fp1_time,\n        nullif(fp2_date, '\\\\N') as fp2_date,\n        nullif(fp2_time, '\\\\N') as fp2_time,\n        nullif(fp3_date, '\\\\N') as fp3_date,\n        nullif(fp3_time, '\\\\N') as fp3_time,\n        nullif(quali_date, '\\\\N') as quali_date,\n        nullif(quali_time, '\\\\N') as quali_time,\n        nullif(sprint_date, '\\\\N') as sprint_date,\n        nullif(sprint_time, '\\\\N') as sprint_time\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_races", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:31.451436Z", "completed_at": "2025-12-05T12:20:31.543811Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:31.590446Z", "completed_at": "2025-12-05T12:20:32.964297Z"}], "thread_id": "Thread-1", "execution_time": 1.5298399925231934, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_results", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".results\n\n),\n\nrenamed as (\n\n    select\n        source.\"resultId\" as result_id,\n        source.\"raceId\" as race_id,\n        source.\"driverId\" as driver_id,\n        source.\"constructorId\" as constructor_id,\n        number as driver_number,\n        grid as grid_position,\n        case \n            when source.\"position\" = 'N' \n                or source.\"position\" = '\\N' \n                or source.\"position\" is null then 0\n            else source.\"position\"::int\n        end as finish_position,\n        source.\"positionText\" as position_text,\n        source.\"positionOrder\" as position_order,\n        points,\n        laps,\n        nullif(time, '-1') as race_time,\n        nullif(milliseconds, '-1') as race_time_milliseconds,\n        nullif(source.\"fastestLap\", '-1') as fastest_lap,\n        nullif(rank, '-1') as fastest_lap_rank,\n        nullif(source.\"fastestLapTime\", '-1') as fastest_lap_time,\n        nullif(source.\"fastestLapSpeed\", '-1') as fastest_lap_speed,\n        source.\"statusId\" as status_id\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:31.463546Z", "completed_at": "2025-12-05T12:20:32.001622Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:32.037972Z", "completed_at": "2025-12-05T12:20:33.087549Z"}], "thread_id": "Thread-2", "execution_time": 1.661505937576294, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_seasons", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".seasons\n\n),\n\nrenamed as (\n\n    select\n        year as season_year,\n        url\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_seasons", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:31.479592Z", "completed_at": "2025-12-05T12:20:32.063194Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:32.067334Z", "completed_at": "2025-12-05T12:20:33.095658Z"}], "thread_id": "Thread-4", "execution_time": 1.6631386280059814, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_sprint_results", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".sprint_results\n\n),\n\nrenamed as (\n\n    select\n        source.\"resultId\" as result_id,\n        source.\"raceId\" as race_id,\n        source.\"driverId\" as driver_id,\n        source.\"constructorId\" as constructor_id,\n        number as driver_number,\n        grid as grid_position,\n        nullif(position, '\\\\N') as finish_position,\n        source.\"positionText\" as position_text,\n        source.\"positionOrder\" as position_order,\n        points,\n        laps,\n        nullif(time, '\\\\N') as sprint_time,\n        nullif(milliseconds, '\\\\N') as sprint_time_milliseconds,\n        nullif(source.\"fastestLap\", '\\\\N') as fastest_lap,\n        nullif(source.\"fastestLapTime\", '\\\\N') as fastest_lap_time,\n        source.\"statusId\" as status_id\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_sprint_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:32.539021Z", "completed_at": "2025-12-05T12:20:32.561389Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:32.564322Z", "completed_at": "2025-12-05T12:20:33.446494Z"}], "thread_id": "Thread-3", "execution_time": 0.9186890125274658, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.omd_dbt_pg.stg_status", "compiled": true, "compiled_code": "with source as (\n\n    select * from omd.\"dbt_dev\".status\n\n),\n\nrenamed as (\n\n    select\n        source.\"statusId\" as status_id,\n        source.\"status\" as status_description\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "omd.\"dbt_dev\".stg_status", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:33.152983Z", "completed_at": "2025-12-05T12:20:33.193537Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:33.195270Z", "completed_at": "2025-12-05T12:20:34.149784Z"}], "thread_id": "Thread-2", "execution_time": 1.0052058696746826, "adapter_response": {"_message": "SELECT 10494", "code": "SELECT", "rows_affected": 10494}, "message": "SELECT 10494", "failures": null, "unique_id": "model.omd_dbt_pg.int_qualifying_enhanced", "compiled": true, "compiled_code": "\n\nwith qualifying as (\n\n    select * from omd.\"dbt_dev\".stg_qualifying\n\n),\n\nraces as (\n\n    select * from omd.\"dbt_dev\".stg_races\n\n),\n\ndrivers as (\n\n    select * from omd.\"dbt_dev\".stg_drivers\n\n),\n\nconstructors as (\n\n    select * from omd.\"dbt_dev\".stg_constructors\n\n),\n\ncircuits as (\n\n    select * from omd.\"dbt_dev\".stg_circuits\n\n),\n\nenhanced as (\n\n    select\n        -- Qualifying identifiers\n        qualifying.qualify_id,\n        qualifying.race_id,\n        qualifying.driver_id,\n        qualifying.constructor_id,\n        \n        -- Race context\n        races.season_year,\n        races.race_round,\n        races.race_name,\n        races.race_date,\n        races.circuit_id,\n        circuits.circuit_name,\n        circuits.location as circuit_location,\n        circuits.country as circuit_country,\n        \n        -- Driver details\n        drivers.driver_ref,\n        drivers.forename || ' ' || drivers.surname as driver_full_name,\n        drivers.driver_code,\n        drivers.nationality as driver_nationality,\n        \n        -- Constructor details\n        constructors.constructor_ref,\n        constructors.constructor_name,\n        constructors.nationality as constructor_nationality,\n        \n        -- Qualifying performance\n        qualifying.driver_number,\n        qualifying.position as qualifying_position,\n        qualifying.q1_time,\n        qualifying.q2_time,\n        qualifying.q3_time,\n        \n        -- Derived flags\n        case when qualifying.position = 1 then true else false end as is_pole_position,\n        case when qualifying.q3_time is not null then true else false end as reached_q3,\n        case when qualifying.q2_time is not null then true else false end as reached_q2\n\n    from qualifying\n    left join races on qualifying.race_id = races.race_id\n    left join drivers on qualifying.driver_id = drivers.driver_id\n    left join constructors on qualifying.constructor_id = constructors.constructor_id\n    left join circuits on races.circuit_id = circuits.circuit_id\n\n)\n\nselect * from enhanced", "relation_name": "omd.\"dbt_dev\".int_qualifying_enhanced", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:33.507537Z", "completed_at": "2025-12-05T12:20:33.542143Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:33.557193Z", "completed_at": "2025-12-05T12:20:34.859536Z"}], "thread_id": "Thread-3", "execution_time": 1.3834731578826904, "adapter_response": {"_message": "SELECT 360", "code": "SELECT", "rows_affected": 360}, "message": "SELECT 360", "failures": null, "unique_id": "model.omd_dbt_pg.int_sprint_results_enhanced", "compiled": true, "compiled_code": "\n\nwith sprint_results as (\n\n    select * from omd.\"dbt_dev\".stg_sprint_results\n\n),\n\nraces as (\n\n    select * from omd.\"dbt_dev\".stg_races\n\n),\n\ndrivers as (\n\n    select * from omd.\"dbt_dev\".stg_drivers\n\n),\n\nconstructors as (\n\n    select * from omd.\"dbt_dev\".stg_constructors\n\n),\n\ncircuits as (\n\n    select * from omd.\"dbt_dev\".stg_circuits\n\n),\n\nstatus as (\n\n    select * from omd.\"dbt_dev\".stg_status\n\n),\n\nenhanced as (\n\n    select\n        -- Sprint identifiers\n        sprint_results.result_id,\n        sprint_results.race_id,\n        sprint_results.driver_id,\n        sprint_results.constructor_id,\n        \n        -- Race context\n        races.season_year,\n        races.race_round,\n        races.race_name,\n        races.race_date,\n        races.circuit_id,\n        circuits.circuit_name,\n        circuits.location as circuit_location,\n        circuits.country as circuit_country,\n        \n        -- Driver details\n        drivers.driver_ref,\n        drivers.forename || ' ' || drivers.surname as driver_full_name,\n        drivers.driver_code,\n        drivers.nationality as driver_nationality,\n        \n        -- Constructor details\n        constructors.constructor_ref,\n        constructors.constructor_name,\n        constructors.nationality as constructor_nationality,\n        \n        -- Sprint performance\n        sprint_results.driver_number,\n        sprint_results.grid_position,\n        sprint_results.finish_position,\n        sprint_results.position_text,\n        sprint_results.position_order,\n        sprint_results.points,\n        sprint_results.laps,\n        sprint_results.sprint_time as finish_time,\n        sprint_results.sprint_time_milliseconds as finish_time_milliseconds,\n        sprint_results.fastest_lap,\n        sprint_results.fastest_lap_time,\n        \n        -- Status\n        sprint_results.status_id,\n        status.status_description,\n        \n        -- Derived flags\n        case when sprint_results.finish_position = '1' then true else false end as is_winner,\n        case when sprint_results.finish_position in ('1', '2', '3') then true else false end as is_podium,\n        \n        -- Position changes\n        case \n            when sprint_results.finish_position is not null \n                and sprint_results.finish_position not in ('N', '\\N')\n                and sprint_results.grid_position is not null\n            then sprint_results.grid_position - cast(sprint_results.finish_position as int)\n            else null  \n        end as positions_gained\n\n    from sprint_results\n    left join races on sprint_results.race_id = races.race_id\n    left join drivers on sprint_results.driver_id = drivers.driver_id\n    left join constructors on sprint_results.constructor_id = constructors.constructor_id\n    left join circuits on races.circuit_id = circuits.circuit_id\n    left join status on sprint_results.status_id = status.status_id\n\n)\n\nselect * from enhanced", "relation_name": "omd.\"dbt_dev\".int_sprint_results_enhanced", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:34.166356Z", "completed_at": "2025-12-05T12:20:34.181599Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:34.182584Z", "completed_at": "2025-12-05T12:20:35.303647Z"}], "thread_id": "Thread-2", "execution_time": 1.1397290229797363, "adapter_response": {"_message": "SELECT 10494", "code": "SELECT", "rows_affected": 10494}, "message": "SELECT 10494", "failures": null, "unique_id": "model.omd_dbt_pg.fct_qualifying_results", "compiled": true, "compiled_code": "\n\nwith enhanced_qualifying as (\n\n    select * from omd.\"dbt_dev\".int_qualifying_enhanced\n\n)\n\nselect\n    -- Primary key\n    qualify_id,\n    \n    -- Foreign keys\n    race_id,\n    driver_id,\n    constructor_id,\n    circuit_id,\n    \n    -- Race context\n    season_year,\n    race_round,\n    race_date,\n    \n    -- Qualifying performance\n    qualifying_position,\n    is_pole_position,\n    \n    -- Qualifying times\n    q1_time,\n    q2_time,\n    q3_time,\n    \n    -- Session progression\n    reached_q2,\n    reached_q3\n\nfrom enhanced_qualifying", "relation_name": "omd.\"dbt_dev\".fct_qualifying_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:33.486065Z", "completed_at": "2025-12-05T12:20:33.534553Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:33.536647Z", "completed_at": "2025-12-05T12:20:35.514687Z"}], "thread_id": "Thread-4", "execution_time": 2.0662059783935547, "adapter_response": {"_message": "SELECT 26759", "code": "SELECT", "rows_affected": 26759}, "message": "SELECT 26759", "failures": null, "unique_id": "model.omd_dbt_pg.int_race_results_enhanced", "compiled": true, "compiled_code": "\n\nwith results as (\n\n    select * from omd.\"dbt_dev\".stg_results\n\n),\n\nraces as (\n\n    select * from omd.\"dbt_dev\".stg_races\n\n),\n\ndrivers as (\n\n    select * from omd.\"dbt_dev\".stg_drivers\n\n),\n\nconstructors as (\n\n    select * from omd.\"dbt_dev\".stg_constructors\n\n),\n\ncircuits as (\n\n    select * from omd.\"dbt_dev\".stg_circuits\n\n),\n\nstatus as (\n\n    select * from omd.\"dbt_dev\".stg_status\n\n),\n\nenhanced as (\n\n    select\n        -- Result identifiers\n        results.result_id,\n        results.race_id,\n        results.driver_id,\n        results.constructor_id,\n        \n        -- Race context\n        races.season_year,\n        races.race_round,\n        races.race_name,\n        races.race_date,\n        races.race_time,\n        races.circuit_id,\n        circuits.circuit_name,\n        circuits.location as circuit_location,\n        circuits.country as circuit_country,\n        \n        -- Driver details\n        drivers.driver_ref,\n        drivers.forename as driver_forename,\n        drivers.surname as driver_surname,\n        drivers.forename || ' ' || drivers.surname as driver_full_name,\n        drivers.driver_code,\n        drivers.driver_number as driver_permanent_number,\n        drivers.nationality as driver_nationality,\n        \n        -- Constructor details\n        constructors.constructor_ref,\n        constructors.constructor_name,\n        constructors.nationality as constructor_nationality,\n        \n        -- Race performance\n        results.driver_number,\n        results.grid_position,\n        results.finish_position,\n        results.position_text,\n        results.position_order,\n        results.points,\n        results.laps,\n        results.race_time as finish_time,\n        results.race_time_milliseconds as finish_time_milliseconds,\n        \n        -- Lap performance\n        results.fastest_lap,\n        results.fastest_lap_rank,\n        results.fastest_lap_time,\n        results.fastest_lap_speed,\n        \n        -- Status\n        results.status_id,\n        status.status_description,\n        \n        -- Derived flags\n        case when results.finish_position = '1' then true else false end as is_winner,\n        case when results.finish_position in ('1', '2', '3') then true else false end as is_podium,\n        case when results.finish_position is not null then true else false end as is_classified,\n        case when results.fastest_lap_rank = '1' then true else false end as has_fastest_lap,\n        case when results.grid_position = 1 then true else false end as started_from_pole,\n        \n        -- Position changes\n        case \n            when results.finish_position is not null and results.grid_position is not null\n            then results.grid_position - results.finish_position\n            else null \n        end as positions_gained\n\n    from results\n    left join races on results.race_id = races.race_id\n    left join drivers on results.driver_id = drivers.driver_id\n    left join constructors on results.constructor_id = constructors.constructor_id\n    left join circuits on races.circuit_id = circuits.circuit_id\n    left join status on results.status_id = status.status_id\n\n)\n\nselect * from enhanced", "relation_name": "omd.\"dbt_dev\".int_race_results_enhanced", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:34.879797Z", "completed_at": "2025-12-05T12:20:34.886828Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:34.887766Z", "completed_at": "2025-12-05T12:20:35.724506Z"}], "thread_id": "Thread-3", "execution_time": 0.8584671020507812, "adapter_response": {"_message": "SELECT 360", "code": "SELECT", "rows_affected": 360}, "message": "SELECT 360", "failures": null, "unique_id": "model.omd_dbt_pg.fct_sprint_results", "compiled": true, "compiled_code": "\n\nwith enhanced_sprint as (\n\n    select * from omd.\"dbt_dev\".int_sprint_results_enhanced\n\n)\n\nselect\n    -- Primary key\n    result_id,\n    \n    -- Foreign keys\n    race_id,\n    driver_id,\n    constructor_id,\n    circuit_id,\n    status_id,\n    \n    -- Race context\n    season_year,\n    race_round,\n    race_date,\n    \n    -- Starting position\n    grid_position,\n    \n    -- Finishing position\n    finish_position,\n    position_order,\n    \n    -- Position change\n    positions_gained,\n    \n    -- Points and results\n    points,\n    is_winner,\n    is_podium,\n    \n    -- Laps\n    laps,\n    \n    -- Times\n    finish_time,\n    finish_time_milliseconds,\n    \n    -- Fastest lap\n    fastest_lap,\n    fastest_lap_time,\n    \n    -- Status\n    status_description\n\nfrom enhanced_sprint", "relation_name": "omd.\"dbt_dev\".fct_sprint_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:32.981263Z", "completed_at": "2025-12-05T12:20:32.989905Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:32.991644Z", "completed_at": "2025-12-05T12:20:35.812437Z"}], "thread_id": "Thread-1", "execution_time": 2.83537220954895, "adapter_response": {"_message": "SELECT 589081", "code": "SELECT", "rows_affected": 589081}, "message": "SELECT 589081", "failures": null, "unique_id": "model.omd_dbt_pg.dim_lap_times", "compiled": true, "compiled_code": "\n\nwith lap_times as (\n\n    select * from omd.\"dbt_dev\".stg_lap_times\n\n),\n\nraces as (\n\n    select \n        race_id,\n        season_year,\n        race_round,\n        race_date,\n        circuit_id\n    from omd.\"dbt_dev\".stg_races\n\n)\n\nselect\n    -- Composite key components\n    lap_times.race_id,\n    lap_times.driver_id,\n    lap_times.lap,\n    \n    -- Race context from races\n    races.season_year,\n    races.race_round,\n    races.race_date,\n    races.circuit_id,\n    \n    -- Lap performance\n    lap_times.position as position_after_lap,\n    lap_times.lap_time,\n    lap_times.lap_time_milliseconds\n\nfrom lap_times\nleft join races on lap_times.race_id = races.race_id", "relation_name": "omd.\"dbt_dev\".dim_lap_times", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:35.566027Z", "completed_at": "2025-12-05T12:20:35.577478Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:35.579354Z", "completed_at": "2025-12-05T12:20:36.543373Z"}], "thread_id": "Thread-2", "execution_time": 0.98124098777771, "adapter_response": {"_message": "SELECT 26759", "code": "SELECT", "rows_affected": 26759}, "message": "SELECT 26759", "failures": null, "unique_id": "model.omd_dbt_pg.fct_race_results", "compiled": true, "compiled_code": "\n\nwith enhanced_results as (\n\n    select * from omd.\"dbt_dev\".int_race_results_enhanced\n\n)\n\nselect\n    -- Primary key\n    result_id,\n    \n    -- Foreign keys\n    race_id,\n    driver_id,\n    constructor_id,\n    circuit_id,\n    status_id,\n    \n    -- Race context\n    season_year,\n    race_round,\n    race_date,\n    \n    -- Starting position\n    grid_position,\n    started_from_pole,\n    \n    -- Finishing position\n    finish_position,\n    position_order,\n    is_classified,\n    \n    -- Position change\n    positions_gained,\n    \n    -- Points and results\n    points,\n    is_winner,\n    is_podium,\n    \n    -- Laps\n    laps,\n    \n    -- Times\n    finish_time,\n    finish_time_milliseconds,\n    \n    -- Fastest lap\n    fastest_lap,\n    fastest_lap_rank,\n    fastest_lap_time,\n    fastest_lap_speed,\n    has_fastest_lap,\n    \n    -- Status\n    status_description\n\nfrom enhanced_results", "relation_name": "omd.\"dbt_dev\".fct_race_results", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:36.567641Z", "completed_at": "2025-12-05T12:20:36.591944Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:36.594192Z", "completed_at": "2025-12-05T12:20:37.648193Z"}], "thread_id": "Thread-4", "execution_time": 1.0945842266082764, "adapter_response": {"_message": "SELECT 77", "code": "SELECT", "rows_affected": 77}, "message": "SELECT 77", "failures": null, "unique_id": "model.omd_dbt_pg.dim_circuits", "compiled": true, "compiled_code": "\n\nwith circuits as (\n\n    select * from omd.\"dbt_dev\".stg_circuits\n\n),\n\ncircuit_stats as (\n\n    select\n        circuit_id,\n        count(distinct race_id) as total_races_held,\n        count(distinct season_year) as seasons_active,\n        min(race_date) as first_race_date,\n        max(race_date) as last_race_date\n    from omd.\"dbt_dev\".fct_race_results\n    group by circuit_id\n\n)\n\nselect\n    -- Primary key\n    circuits.circuit_id,\n    \n    -- Circuit identification\n    circuits.circuit_ref,\n    circuits.circuit_name,\n    \n    -- Location information\n    circuits.location,\n    circuits.country,\n    circuits.latitude,\n    circuits.longitude,\n    circuits.altitude,\n    \n    -- Usage statistics\n    coalesce(circuit_stats.total_races_held, 0) as total_races_held,\n    coalesce(circuit_stats.seasons_active, 0) as seasons_active,\n    circuit_stats.first_race_date,\n    circuit_stats.last_race_date,\n    \n    -- Reference\n    circuits.url\n\nfrom circuits\nleft join circuit_stats on circuits.circuit_id = circuit_stats.circuit_id", "relation_name": "omd.\"dbt_dev\".dim_circuits", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:36.580207Z", "completed_at": "2025-12-05T12:20:36.593438Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:36.619756Z", "completed_at": "2025-12-05T12:20:37.651158Z"}], "thread_id": "Thread-1", "execution_time": 1.0945279598236084, "adapter_response": {"_message": "SELECT 861", "code": "SELECT", "rows_affected": 861}, "message": "SELECT 861", "failures": null, "unique_id": "model.omd_dbt_pg.dim_drivers", "compiled": true, "compiled_code": "\n\nwith drivers as (\n\n    select * from omd.\"dbt_dev\".stg_drivers\n\n),\n\ndriver_stats as (\n\n    select\n        driver_id,\n        count(*) as total_races,\n        sum(case when is_winner then 1 else 0 end) as total_wins,\n        sum(case when is_podium then 1 else 0 end) as total_podiums,\n        sum(points) as total_points,\n        count(distinct season_year) as seasons_active,\n        min(race_date) as first_race_date,\n        max(race_date) as last_race_date\n    from omd.\"dbt_dev\".fct_race_results\n    group by driver_id\n\n)\n\nselect\n    -- Primary key\n    drivers.driver_id,\n    \n    -- Driver identification\n    drivers.driver_ref,\n    drivers.driver_number,\n    drivers.driver_code,\n    \n    -- Driver name\n    drivers.forename,\n    drivers.surname,\n    drivers.forename || ' ' || drivers.surname as full_name,\n    \n    -- Personal information\n    drivers.date_of_birth,\n    drivers.nationality,\n    \n    -- Career statistics\n    coalesce(driver_stats.total_races, 0) as total_races,\n    coalesce(driver_stats.total_wins, 0) as total_wins,\n    coalesce(driver_stats.total_podiums, 0) as total_podiums,\n    coalesce(driver_stats.total_points, 0) as total_points,\n    coalesce(driver_stats.seasons_active, 0) as seasons_active,\n    driver_stats.first_race_date,\n    driver_stats.last_race_date,\n    \n    -- Reference\n    drivers.url\n\nfrom drivers\nleft join driver_stats on drivers.driver_id = driver_stats.driver_id", "relation_name": "omd.\"dbt_dev\".dim_drivers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:36.573949Z", "completed_at": "2025-12-05T12:20:36.592809Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:36.610821Z", "completed_at": "2025-12-05T12:20:37.728804Z"}], "thread_id": "Thread-3", "execution_time": 1.1716501712799072, "adapter_response": {"_message": "SELECT 212", "code": "SELECT", "rows_affected": 212}, "message": "SELECT 212", "failures": null, "unique_id": "model.omd_dbt_pg.dim_constructors", "compiled": true, "compiled_code": "\n\nwith constructors as (\n\n    select * from omd.\"dbt_dev\".stg_constructors\n\n),\n\nconstructor_stats as (\n\n    select\n        constructor_id,\n        count(*) as total_race_entries,\n        sum(case when is_winner then 1 else 0 end) as total_wins,\n        sum(case when is_podium then 1 else 0 end) as total_podiums,\n        sum(points) as total_points,\n        count(distinct season_year) as seasons_active,\n        min(race_date) as first_race_date,\n        max(race_date) as last_race_date\n    from omd.\"dbt_dev\".fct_race_results\n    group by constructor_id\n\n)\n\nselect\n    -- Primary key\n    constructors.constructor_id,\n    \n    -- Constructor identification\n    constructors.constructor_ref,\n    constructors.constructor_name,\n    \n    -- Constructor information\n    constructors.nationality,\n    \n    -- Career statistics\n    coalesce(constructor_stats.total_race_entries, 0) as total_race_entries,\n    coalesce(constructor_stats.total_wins, 0) as total_wins,\n    coalesce(constructor_stats.total_podiums, 0) as total_podiums,\n    coalesce(constructor_stats.total_points, 0) as total_points,\n    coalesce(constructor_stats.seasons_active, 0) as seasons_active,\n    constructor_stats.first_race_date,\n    constructor_stats.last_race_date,\n    \n    -- Reference\n    constructors.url\n\nfrom constructors\nleft join constructor_stats on constructors.constructor_id = constructor_stats.constructor_id", "relation_name": "omd.\"dbt_dev\".dim_constructors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:37.665412Z", "completed_at": "2025-12-05T12:20:37.671599Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:37.672322Z", "completed_at": "2025-12-05T12:20:38.449823Z"}], "thread_id": "Thread-4", "execution_time": 0.7873249053955078, "adapter_response": {"_message": "SELECT 139", "code": "SELECT", "rows_affected": 139}, "message": "SELECT 139", "failures": null, "unique_id": "model.omd_dbt_pg.dim_status", "compiled": true, "compiled_code": "\n\nwith status as (\n\n    select * from omd.\"dbt_dev\".stg_status\n\n),\n\nstatus_usage as (\n\n    select\n        status_id,\n        count(*) as times_used\n    from omd.\"dbt_dev\".fct_race_results\n    group by status_id\n\n)\n\nselect\n    -- Primary key\n    status.status_id,\n    \n    -- Status information\n    status.status_description,\n    \n    -- Classification\n    case\n        when status.status_description in ('Finished', '+1 Lap', '+2 Laps', '+3 Laps', '+4 Laps', '+5 Laps') \n            then 'Classified'\n        when status.status_description like 'Accident%' \n            then 'Accident'\n        when status.status_description like 'Collision%' \n            then 'Collision'\n        when status.status_description like '%mechanical%' or status.status_description like '%engine%' or status.status_description like '%gearbox%'\n            then 'Mechanical'\n        when status.status_description = 'Disqualified'\n            then 'Disqualified'\n        else 'Other DNF'\n    end as status_category,\n    \n    -- Usage statistics\n    coalesce(status_usage.times_used, 0) as times_used\n\nfrom status\nleft join status_usage on status.status_id = status_usage.status_id", "relation_name": "omd.\"dbt_dev\".dim_status", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-05T12:20:36.585718Z", "completed_at": "2025-12-05T12:20:36.609240Z"}, {"name": "execute", "started_at": "2025-12-05T12:20:36.628733Z", "completed_at": "2025-12-05T12:20:37.725963Z"}], "thread_id": "Thread-2", "execution_time": 1.1684720516204834, "adapter_response": {"_message": "SELECT 75", "code": "SELECT", "rows_affected": 75}, "message": "SELECT 75", "failures": null, "unique_id": "model.omd_dbt_pg.dim_seasons", "compiled": true, "compiled_code": "\n\nwith seasons as (\n\n    select * from omd.\"dbt_dev\".stg_seasons\n\n),\n\nseason_stats as (\n\n    select\n        season_year,\n        count(distinct race_id) as total_races,\n        count(distinct circuit_id) as unique_circuits,\n        count(distinct driver_id) as unique_drivers,\n        count(distinct constructor_id) as unique_constructors\n    from omd.\"dbt_dev\".fct_race_results\n    group by season_year\n\n)\n\nselect\n    -- Primary key\n    seasons.season_year,\n    \n    -- Season statistics\n    coalesce(season_stats.total_races, 0) as total_races,\n    coalesce(season_stats.unique_circuits, 0) as unique_circuits,\n    coalesce(season_stats.unique_drivers, 0) as unique_drivers,\n    coalesce(season_stats.unique_constructors, 0) as unique_constructors,\n    \n    -- Reference\n    seasons.url\n\nfrom seasons\nleft join season_stats on seasons.season_year = season_stats.season_year", "relation_name": "omd.\"dbt_dev\".dim_seasons", "batch_results": null}], "elapsed_time": 12.9826180934906, "args": {"profiles_dir": "/Users/stijndolphen/dbt-omd-pg", "state_modified_compare_vars": false, "log_path": "/Users/stijndolphen/dbt-omd-pg/logs", "require_resource_names_without_spaces": true, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "partial_parse_file_diff": true, "printer_width": 80, "exclude": [], "vars": {}, "indirect_selection": "eager", "state_modified_compare_more_unrendered_values": false, "partial_parse": true, "empty": false, "log_format_file": "debug", "project_dir": "/Users/stijndolphen/dbt-omd-pg", "log_file_max_bytes": 10485760, "log_format": "default", "log_level": "info", "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "send_anonymous_usage_stats": true, "macro_debugging": false, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "which": "run", "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "favor_state": false, "upload_to_artifacts_ingest_api": false, "invocation_command": "dbt run", "use_fast_test_edges": false, "cache_selected_only": false, "static_parser": true, "use_colors_file": true, "source_freshness_run_project_hooks": true, "show_resource_report": false, "strict_mode": false, "require_all_warnings_handled_by_warn_error": false, "require_nested_cumulative_type_params": false, "populate_cache": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_generic_test_arguments_property": true, "write_json": true, "log_level_file": "debug", "version_check": true}}